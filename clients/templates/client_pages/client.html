{% extends 'base.html' %} 
{% block contentPage %}

{% include 'accounts/header.html' with header_title="Clients & Prospects" %}

<div x-data="factDataComponent()" x-init="init()" x-cloak>

    <div class="w-full inline-flex items-center justify-between py-4">
        
        <div>
            <button @click="client_view_list=true; saveClientView()" type="button" class="text-blue-700 border border-blue-700 hover:bg-blue-700 hover:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm p-2.5 text-center inline-flex items-center me-2 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:focus:ring-blue-800 dark:hover:bg-blue-500">
                <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M10 20q-.825 0-1.412-.587T8 18t.588-1.412T10 16h10q.825 0 1.413.588T22 18t-.587 1.413T20 20zm0-6q-.825 0-1.412-.587T8 12t.588-1.412T10 10h10q.825 0 1.413.588T22 12t-.587 1.413T20 14zm0-6q-.825 0-1.412-.587T8 6t.588-1.412T10 4h10q.825 0 1.413.588T22 6t-.587 1.413T20 8zM4 8q-.825 0-1.412-.587T2 6t.588-1.412T4 4t1.413.588T6 6t-.587 1.413T4 8m0 6q-.825 0-1.412-.587T2 12t.588-1.412T4 10t1.413.588T6 12t-.587 1.413T4 14m0 6q-.825 0-1.412-.587T2 18t.588-1.412T4 16t1.413.588T6 18t-.587 1.413T4 20"/></svg>
                <span class="sr-only">View list</span>
            </button>
            <button @click="client_view_list=false; saveClientView()" type="button" class="text-blue-700 border border-blue-700 hover:bg-blue-700 hover:text-white focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm p-2.5 text-center inline-flex items-center me-2 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:focus:ring-blue-800 dark:hover:bg-blue-500">
                <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M22 19.75V4.25zm-20-11v-4.5h4.25v4.5zm5.25 0v-4.5h4.25v4.5zm5.25 0v-4.5h4.25v4.5zm5.25 0v-4.5H22v4.5zm0 5.5v-4.5H22v4.5zm-5.25 0v-4.5h4.25v4.5zm-5.25 0v-4.5h4.25v4.5zm-5.25 0v-4.5h4.25v4.5zm15.75 5.5v-4.5H22v4.5zm-5.25 0v-4.5h4.25v4.5zm-5.25 0v-4.5h4.25v4.5zm-5.25 0v-4.5h4.25v4.5z"/></svg>
                <span class="sr-only">View card</span>
            </button>
        </div>

        <button type="button" data-modal-target="new_client-modal" data-modal-toggle="new_client-modal" class="text-blue-700 hover:text-white border border-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center me-2 mb-2 dark:border-blue-500 dark:text-blue-500 dark:hover:text-white dark:hover:bg-blue-500 dark:focus:ring-blue-800">Nouveau client</button>
    </div>

    <div x-show="!client_view_list" class="flex items-center justify-start gap-2 flex-wrap">
        {% for client in clients_list %}  
        <div class="w-full max-w-sm bg-white border border-gray-200 rounded-lg shadow dark:bg-gray-800 dark:border-gray-700">
            <div class="flex justify-end px-4 pt-4">
                <button id="dropdownButton" data-dropdown-toggle="dropdown{{ client.id }}" class="inline-block text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:ring-4 focus:outline-none focus:ring-gray-200 dark:focus:ring-gray-700 rounded-lg text-sm p-1.5" type="button">
                    <span class="sr-only">Open dropdown</span>
                    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 3">
                        <path d="M2 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm6.041 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM14 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z"/>
                    </svg>
                </button>
                <!-- Dropdown menu -->
                <div id="dropdown{{ client.id }}" class="z-10 hidden text-base list-none bg-white divide-y divide-gray-100 rounded-lg shadow w-44 dark:bg-gray-700">
                    <ul class="py-2" aria-labelledby="dropdownButton">
                    <li>
                        <button data-modal-target="modif-modal-{{ client.id }}" data-modal-toggle="modif-modal-{{ client.id }}" class="w-full text-start block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-200 dark:hover:text-white">Modifier</button>
                    </li>
                    <li>
                        <a href="{% url 'facture:facture' %}?client_id={{ client.id }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-200 dark:hover:text-white">Créer un facture</a>
                    </li>
                    <li>
                        <button data-modal-target="del-modal-{{ client.id }}" data-modal-toggle="del-modal-{{ client.id }}" class="w-full text-start block px-4 py-2 text-sm text-red-600 hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-200 dark:hover:text-white">Supprimer</button>
                    </li>
                    </ul>
                </div>
            </div>
            <div class="flex flex-col items-center pb-10">
                {% if client.photo %}
                <img class="w-10 h-10 rounded-full" src="{{ client.photo.url }}" alt="{{ client.name }} image">
                {% else %}
                <img class="w-10 h-10 rounded-full" src="https://ui-avatars.com/api/?name={{client.name}}+{{client.commercial_name}}" alt="{{client.name}} image">
                {% endif %}
                <h5 class="mb-1 text-xl font-medium text-gray-900 dark:text-white">{{ client.name }}</h5>
                <span class="text-sm text-gray-500 dark:text-gray-400">{{ client.email }}</span>
                <div class="flex mt-4 md:mt-6">
                    <a href="tel:{{ client.tel }}" class="inline-flex items-center px-4 py-2 text-sm font-medium text-center text-white bg-blue-700 rounded-lg hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">Appeler</a>
                    <a href="mailto:{{ client.email }}" class="py-2 px-4 ms-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-lg border border-gray-200 hover:bg-gray-100 hover:text-blue-700 focus:z-10 focus:ring-4 focus:ring-gray-100 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700">Message</a>
                </div>
            </div>
            <!-- Modal Modification -->
            <div id="modif-modal-{{ client.id }}" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
                <div class="relative p-4 w-full max-w-[50vw] max-h-full">
                    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                        <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600">
                            <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
                                Modifier {{ client.name }}
                            </h3>
                            <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="modif-modal-{{ client.id }}">
                                <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                                </svg>
                                <span class="sr-only">Fermer</span>
                            </button>
                        </div>
                        <form class="p-4 md:p-5" action="{% url 'client:edit_client' client.id %}" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <div class="flex flex-col items-center justify-center w-full">
                                
                                {% if client.photo %}
                                <img id="preview-image-{{ client.id }}" class="w-32 h-32 rounded-full object-cover mb-4" src="{{ client.photo.url }}" alt="Preview">                                                
                                {% endif %}                                               
                                
                                <div id="upload-zone-{{ client.id }}" class="w-full hidden">
                                    <label for="photo-{{ client.id }}" class="flex flex-col items-center justify-center w-full h-44 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600">
                                        <div class="flex flex-col items-center justify-center w-full pt-5 pb-6">
                                            <svg class="w-8 h-8 mb-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16">
                                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"/>
                                            </svg>
                                            <p class="mb-2 text-sm text-center text-gray-500 dark:text-gray-400"><span class="font-semibold">Cliquez pour télécharger votre photo de profil</span> ou glisser-déposer</p>
                                            <p class="text-xs text-gray-500 dark:text-gray-400">SVG, PNG, JPG or GIF (MAX. 800x400px)</p>
                                        </div>
                                    </label>
                                </div>
                                <input id="photo-{{ client.id }}" name="photo" type="file" class="hidden" accept="image/*" onchange="editpreviewImage(this, '{{ client.id }}')"/>
                                
                                <button id="cancel-button-{{ client.id }}" type="button" class="mt-4 text-white bg-red-700 hover:bg-red/80 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center items-center dark:bg-red/60 dark:hover:bg-red/70 dark:focus:ring-red-800" onclick="toggleUploadZone('{{ client.id }}')">
                                    Changer la photo
                                    <svg class="w-4 h-4 ms-2 inline" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                                    </svg>
                                </button>
                            </div>

                            <div class="grid gap-4 mb-4 grid-cols-2">
                                <div class="col-span-2 sm:col-span-1 mt-2">
                                    <label for="name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Nom du tier</label>
                                    <input type="text" name="name" id="name" value="{{ client.name }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required="">
                                </div>
                                <div class="col-span-2 sm:col-span-1 mt-2">
                                    <label for="commercial_name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Nom alternatif (commercial, marque, ...)</label>
                                    <input type="text" name="commercial_name" id="commercial_name" value="{{ client.commercial_name }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required="">
                                </div>
                                <div class="col-span-2">
                                    <label for="post" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Poste</label>
                                    <input type="text" name="post" id="post" value="{{ client.post }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                </div>
                                <div class="col-span-2 sm:col-span-1">
                                    <label for="tel1" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">N° Tel 1</label>
                                    <input type="tel" name="tel" id="tel1" value="{{ client.tel }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required="">
                                </div>
                                <div class="col-span-2 sm:col-span-1">
                                    <label for="tel2" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">N° Tel 2</label>
                                    <input type="tel" name="tel2" id="tel2" value="{{ client.tel2 }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                </div>
                                <div class="col-span-2 sm:col-span-1">
                                    <label for="email" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Email</label>
                                    <input type="email" name="email" id="email" value="{{ client.email }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required="">
                                </div>
                                <div class="col-span-2 sm:col-span-1">
                                    <label for="adresse" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Adresse</label>
                                    <input type="text" name="adresse" id="adresse" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" 
                                    {% if client.adresse %}
                                        value="{{ client.adresse }}"
                                    {% endif %}
                                    placeholder="Ex: Rue de la belle vie ..." >
                                </div>
                                <div class="col-span-2">
                                    <label for="type" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Type du client</label>
                                    <select name="type_client" id="type" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                        <option value="Client" {% if client.type_client == 'Client' %}selected{% endif %}>Client</option>
                                        <option value="Prospect" {% if client.type_client == 'Prospect' %}selected{% endif %}>Prospect</option>
                                        <option value="Fourniseur" {% if client.type_client == 'Fourniseur' %}selected{% endif %}>Fourniseur</option>
                                        <option value="Client-Prospect" {% if client.type_client == 'Client-Prospect' %}selected{% endif %}>Client - Prospect</option>
                                        <option value="Client-Fourniseur" {% if client.type_client == 'Client-Fourniseur' %}selected{% endif %}>Client - Fourniseur</option>
                                    </select>
                                </div>
                                {% comment %} Disponibilité {% endcomment %}
                                {% if client.disponibilite %}
                                    <div class="col-span-2">
                                        <label for="disponibilite" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Disponibilité</label>
                                        <div class="col-span-2">
                                            <select id="select-jour" class="mb-4 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" onchange="ajouterLigneDisponibilite(this.value, {{ client.id }})">
                                                <option value="">Sélectionner un jour</option>
                                                <option value="Lundi - Vendredi">Lundi - Vendredi</option>
                                                <option value="Lundi">Lundi</option>
                                                <option value="Mardi">Mardi</option>
                                                <option value="Mercredi">Mercredi</option>
                                                <option value="Jeudi">Jeudi</option>
                                                <option value="Vendredi">Vendredi</option>
                                                <option value="Samedi">Samedi</option>
                                                <option value="Dimanche">Dimanche</option>
                                            </select>
                                            <div id="disponibilite-dynamique-{{ client.id }}">
                                                {% for jour, heures in client.disponibilite.items %}
                                                    <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                                        <div class="flex items-center mr-2 w-[15%]">
                                                            <span class="text-sm font-medium text-gray-900 dark:text-gray-300">{{ jour }}</span>
                                                        </div>
                                                        <div class="flex items-center space-x-4 flex-1 w-[85%]">
                                                            <div class="flex-1">
                                                                <div class="relative">
                                                                    <div class="absolute inset-y-0 end-0 top-0 flex items-center pe-3.5 pointer-events-none">
                                                                        <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                                                            <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z" clip-rule="evenodd"/>
                                                                        </svg>
                                                                    </div>
                                                                    <input type="time" 
                                                                            name="start-time-{{ jour }}"
                                                                            class="bg-white border leading-none border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                                                            value="{{ heures.start }}"
                                                                            required>
                                                                </div>
                                                            </div>
                                                            <span class="text-gray-500">à</span>
                                                            <div class="flex-1">
                                                                <div class="relative">
                                                                    <div class="absolute inset-y-0 end-0 top-0 flex items-center pe-3.5 pointer-events-none">
                                                                        <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                                                            <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z" clip-rule="evenodd"/>
                                                                        </svg>
                                                                    </div>
                                                                    <input type="time" 
                                                                            name="end-time-{{ jour }}"
                                                                            class="bg-white border leading-none border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                                                            value="{{ heures.end }}"
                                                                            required>
                                                                </div>
                                                            </div>
                                                            <div class="ml-4">
                                                                <button type="button" class="delete-day inline-flex items-center p-2 text-sm font-medium text-center text-gray-500 hover:text-gray-800 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg focus:outline-none dark:text-gray-400 dark:hover:text-gray-100" onclick="supprimerLigneDisponibilite(this)">
                                                                    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                                                        <path fill-rule="evenodd" d="M8.586 2.586A2 2 0 0 1 10 2h4a2 2 0 0 1 2 2v2h3a1 1 0 1 1 0 2v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V8a1 1 0 0 1 0-2h3V4a2 2 0 0 1 .586-1.414ZM10 6h4V4h-4v2Zm1 4a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Zm4 0a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Z" clip-rule="evenodd"/>
                                                                    </svg>
                                                                    <span class="sr-only">Delete</span>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                {% endfor %}
                                            </div>
                                        </div>                                                    
                                    </div>
                                {% endif %}
                                <div class="col-span-2">
                                    <label for="message" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Description sur votre facture</label>
                                    <textarea id="message" rows="4" name="description_facture" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Ecrirer ici ...">{{ client.description_facture }}</textarea>          
                                </div>
                            </div>
                            <button type="submit" class="text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                                Sauvegarder
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            {% comment %} Modal suppression {% endcomment %}
            <div id="del-modal-{{ client.id }}" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
                <div class="relative p-4 w-full max-w-md max-h-full">
                    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                        <button type="button" class="absolute top-3 end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="del-modal-{{ client.id }}">
                            <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                            </svg>
                            <span class="sr-only">Fermer</span>
                        </button>
                        <div class="p-4 md:p-5 text-center">
                            <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                            </svg>
                            <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Êtes-vous sûr de vouloir supprimer ce client ?</h3>
                            <a href="{% url 'client:del_client' client.id %}" class="text-white bg-red/60 dark:bg-red/60 hover:bg-red/80 dark:hover:bg-red/80 focus:ring-4 focus:outline-none focus:ring-red/30 dark:focus:ring-red/80 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center me-2">
                                Oui, supprimer
                            </a>
                            <button data-modal-hide="del-modal-{{ client.id }}" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                                Non, annuler
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <div x-show="client_view_list" class="relative overflow-x-auto shadow-md sm:rounded-lg my-4">
        <div class="flex items-center justify-between flex-column flex-wrap md:flex-row space-y-4 md:space-y-0 pb-4 bg-white dark:bg-gray-700">
            <div class="flex items-center gap-2 text-white mx-2 dark:text-gray-900">
                <span class="px-5 text-gray-900 dark:text-white">Filtre : </span>
                <div>
                    <label for="underline_select" class="sr-only">type client select</label>
                    <select id="underline_select" onchange="window.location.href='?type=' + this.value" class="block py-2.5 px-2 text-sm text-gray-600 bg-transparent border-0 border-b-2 border-gray-200 appearance-none dark:text-gray-300 dark:bg-gray-700 dark:border-gray-300 focus:outline-none focus:ring-0 focus:border-gray-400 peer">
                        <option value="" {% if not request.GET.type %}selected{% endif %}>Tous</option>
                        <option value="Client" {% if request.GET.type == 'Client' %}selected{% endif %}>Client</option>
                        <option value="Prospect" {% if request.GET.type == 'Prospect' %}selected{% endif %}>Prospect</option>
                        <option value="Fourniseur" {% if request.GET.type == 'Fourniseur' %}selected{% endif %}>Fourniseur</option>
                        <option value="Client-Prospect" {% if request.GET.type == 'Client-Prospect' %}selected{% endif %}>Client - Prospect</option>
                        <option value="Client-Fourniseur" {% if request.GET.type == 'Client-Fourniseur' %}selected{% endif %}>Client - Fourniseur</option>
                    </select>
                </div>                
            </div>
            <div class="relative py-4 px-2">
                <label for="table-search" class="sr-only">recherche</label>
                <div class="absolute inset-y-0 rtl:inset-r-0 start-0 flex items-center ps-3 pointer-events-none">
                    <svg class="w-4 h-4 mx-2 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"/>
                    </svg>
                </div>
                <form method="GET" action="{% url 'client:client' %}">
                    <input type="text" name="search" value="{{ search_query }}" id="table-search-users" class="block p-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg w-80 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Recherche ...">
                </form>
            </div>
        </div>
        <table class="w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400">
            <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                <tr>
                    <th scope="col" class="p-4">
                        <div class="flex items-center">
                            <input id="checkbox-all-search" type="checkbox" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                            <label for="checkbox-all-search" class="sr-only">checkbox</label>
                        </div>
                    </th>
                    <th scope="col" class="px-6 py-3">
                        Nom
                    </th>
                    <th scope="col" class="px-6 py-3">
                        Nom commercial
                    </th>
                    <th scope="col" class="px-6 py-3">
                        Contact
                    </th>
                    <th scope="col" class="px-6 py-3">
                        Type du client
                    </th>
                    <th scope="col" class="px-6 py-3">
                        Action
                    </th>
                </tr>
            </thead>
            <tbody>
                
                {% for client in clients_list %}
                <tr class="odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
                    <td class="w-4 p-4">
                        <div class="flex items-center">
                            <input id="checkbox-table-search-1" type="checkbox" class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 dark:focus:ring-blue-600 dark:ring-offset-gray-800 dark:focus:ring-offset-gray-800 focus:ring-2 dark:bg-gray-700 dark:border-gray-600">
                            <label for="checkbox-table-search-1" class="sr-only">checkbox</label>
                        </div>
                    </td>
                    <th scope="row" class="flex items-center px-6 py-4 text-gray-900 whitespace-nowrap dark:text-white">
                        
                        {% if client.photo %}
                        <img class="w-10 h-10 rounded-full" src="{{ client.photo.url }}" alt="Jese image">
                        {% else %}
                        <img class="w-10 h-10 rounded-full" src="https://ui-avatars.com/api/?name={{client.name}}+{{client.commercial_name}}" alt="Jese image">
                        {% endif %}                            
                        <div class="ps-3">
                            <div class="text-base font-semibold">{{ client.name }}</div>
                            <div class="font-normal text-gray-500">{{ client.post }}</div>
                        </div>  
                    </th>
                    <td class="px-6 py-4">
                        {{ client.commercial_name }}
                    </td>
                    <td class="px-6 py-4 ps-3">
                        <div class="flex items-center">
                            <a href="mailto:{{ client.email }}">{{ client.email }} </a>
                        </div>
                        <div class="flex items-center">
                            <a href="tel:{{ client.tel }}"> {{ client.tel }} </a>
                            {% if client.tel2 %}
                                / <a href="tel:{{ client.tel2 }}">{{ client.tel2 }} </a>                        
                            {% endif %}
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex items-center">
                            {{ client.type_client }}
                        </div>
                    </td>
                    <td class="flex items-center gap-1 px-6 py-4">

                        <!-- Bouton crée un facture -->
                        <a href="{% url 'facture:facture' %}?client_id={{ client.id }}" class="px-3 py-2 text-xs font-medium text-center inline-flex items-center text-blue-700 hover:text-blue-900 dark:text-blue-500 dark:hover:text-blue-600">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none"><path d="M2.924 4.129A2.25 2.25 0 0 1 5.171 2H6.33a2.25 2.25 0 0 1 2.247 2.129l.838 15.5A2.25 2.25 0 0 1 7.167 22H4.333a2.25 2.25 0 0 1-2.246-2.371l.837-15.5zM5.171 3.5a.75.75 0 0 0-.749.71l-.838 15.5a.75.75 0 0 0 .75.79h2.833a.75.75 0 0 0 .749-.79l-.838-15.5a.75.75 0 0 0-.75-.71H5.172z" fill="currentColor"/><path d="M9.512 22H19.75A2.25 2.25 0 0 0 22 19.75V6a.75.75 0 0 0-1.27-.541l-4.98 4.781V6a.75.75 0 0 0-1.228-.578L9.856 9.284l.1 1.864l4.294-3.554V12a.75.75 0 0 0 1.27.541L20.5 7.76v11.99a.75.75 0 0 1-.75.75h-1V16A1.75 1.75 0 0 0 17 14.25h-4A1.75 1.75 0 0 0 11.25 16v4.5h-.92a3.248 3.248 0 0 1-.818 1.5zm7.738-6v4.25h-4.5V16a.25.25 0 0 1 .25-.25h4a.25.25 0 0 1 .25.25z" fill="currentColor"/></g></svg>
                        </a>

                        <!-- Bouton Modifier -->
                        <button data-modal-target="edit-modal-{{ client.id }}" data-modal-toggle="edit-modal-{{ client.id }}" type="button" class="px-3 py-2 text-xs font-medium text-center inline-flex items-center text-blue-700 hover:text-blue-900 dark:text-blue-500 dark:hover:text-blue-600">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83l3.75 3.75l1.83-1.83z"/></svg>
                        </button>

                        <!-- Modal Modification -->
                        <div id="edit-modal-{{ client.id }}" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
                            <div class="relative p-4 w-full max-w-[50vw] max-h-full">
                                <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                                    <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600">
                                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white">
                                            Modifier {{ client.name }}
                                        </h3>
                                        <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="edit-modal-{{ client.id }}">
                                            <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                                            </svg>
                                            <span class="sr-only">Fermer</span>
                                        </button>
                                    </div>
                                    <form class="p-4 md:p-5" action="{% url 'client:edit_client' client.id %}" method="POST" enctype="multipart/form-data">
                                        {% csrf_token %}
                                        <div class="flex flex-col items-center justify-center w-full">
                                            
                                            {% if client.photo %}
                                            <img id="preview-image-{{ client.id }}" class="w-32 h-32 rounded-full object-cover mb-4" src="{{ client.photo.url }}" alt="Preview">                                                
                                            {% endif %}                                               
                                            
                                            <div id="upload-zone-{{ client.id }}" class="w-full hidden">
                                                <label for="photo-{{ client.id }}" class="flex flex-col items-center justify-center w-full h-44 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600">
                                                    <div class="flex flex-col items-center justify-center w-full pt-5 pb-6">
                                                        <svg class="w-8 h-8 mb-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16">
                                                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"/>
                                                        </svg>
                                                        <p class="mb-2 text-sm text-center text-gray-500 dark:text-gray-400"><span class="font-semibold">Cliquez pour télécharger votre photo de profil</span> ou glisser-déposer</p>
                                                        <p class="text-xs text-gray-500 dark:text-gray-400">SVG, PNG, JPG or GIF (MAX. 800x400px)</p>
                                                    </div>
                                                </label>
                                            </div>
                                            <input id="photo-{{ client.id }}" name="photo" type="file" class="hidden" accept="image/*" onchange="editpreviewImage(this, '{{ client.id }}')"/>
                                            
                                            <button id="cancel-button-{{ client.id }}" type="button" class="mt-4 text-white bg-red-700 hover:bg-red/80 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center items-center dark:bg-red/60 dark:hover:bg-red/70 dark:focus:ring-red-800" onclick="toggleUploadZone('{{ client.id }}')">
                                                Changer la photo
                                                <svg class="w-4 h-4 ms-2 inline" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                                                </svg>
                                            </button>
                                        </div>

                                        <div class="grid gap-4 mb-4 grid-cols-2">
                                            <div class="col-span-2 sm:col-span-1 mt-2">
                                                <label for="name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Nom du tier</label>
                                                <input type="text" name="name" id="name" value="{{ client.name }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required="">
                                            </div>
                                            <div class="col-span-2 sm:col-span-1 mt-2">
                                                <label for="commercial_name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Nom alternatif (commercial, marque, ...)</label>
                                                <input type="text" name="commercial_name" id="commercial_name" value="{{ client.commercial_name }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required="">
                                            </div>
                                            <div class="col-span-2">
                                                <label for="post" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Poste</label>
                                                <input type="text" name="post" id="post" value="{{ client.post }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                            </div>
                                            <div class="col-span-2 sm:col-span-1">
                                                <label for="tel1" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">N° Tel 1</label>
                                                <input type="tel" name="tel" id="tel1" value="{{ client.tel }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required="">
                                            </div>
                                            <div class="col-span-2 sm:col-span-1">
                                                <label for="tel2" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">N° Tel 2</label>
                                                <input type="tel" name="tel2" id="tel2" value="{{ client.tel2 }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                            </div>
                                            <div class="col-span-2 sm:col-span-1">
                                                <label for="email" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Email</label>
                                                <input type="email" name="email" id="email" value="{{ client.email }}" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" required="">
                                            </div>
                                            <div class="col-span-2 sm:col-span-1">
                                                <label for="adresse" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Adresse</label>
                                                <input type="text" name="adresse" id="adresse" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" 
                                                {% if client.adresse %}
                                                    value="{{ client.adresse }}"
                                                {% endif %}
                                                placeholder="Ex: Rue de la belle vie ..." >
                                            </div>
                                            <div class="col-span-2">
                                                <label for="type" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Type du client</label>
                                                <select name="type_client" id="type" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500">
                                                    <option value="Client" {% if client.type_client == 'Client' %}selected{% endif %}>Client</option>
                                                    <option value="Prospect" {% if client.type_client == 'Prospect' %}selected{% endif %}>Prospect</option>
                                                    <option value="Fourniseur" {% if client.type_client == 'Fourniseur' %}selected{% endif %}>Fourniseur</option>
                                                    <option value="Client-Prospect" {% if client.type_client == 'Client-Prospect' %}selected{% endif %}>Client - Prospect</option>
                                                    <option value="Client-Fourniseur" {% if client.type_client == 'Client-Fourniseur' %}selected{% endif %}>Client - Fourniseur</option>
                                                </select>
                                            </div>
                                            {% comment %} Disponibilité {% endcomment %}
                                            {% if client.disponibilite %}
                                                <div class="col-span-2">
                                                    <label for="disponibilite" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Disponibilité</label>
                                                    <div class="col-span-2">
                                                        <select id="select-jour" class="mb-4 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" onchange="ajouterLigneDisponibilite(this.value, {{ client.id }})">
                                                            <option value="">Sélectionner un jour</option>
                                                            <option value="Lundi - Vendredi">Lundi - Vendredi</option>
                                                            <option value="Lundi">Lundi</option>
                                                            <option value="Mardi">Mardi</option>
                                                            <option value="Mercredi">Mercredi</option>
                                                            <option value="Jeudi">Jeudi</option>
                                                            <option value="Vendredi">Vendredi</option>
                                                            <option value="Samedi">Samedi</option>
                                                            <option value="Dimanche">Dimanche</option>
                                                        </select>
                                                        <div id="disponibilite-dynamique-{{ client.id }}">
                                                            {% for jour, heures in client.disponibilite.items %}
                                                                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                                                                    <div class="flex items-center mr-2 w-[15%]">
                                                                        <span class="text-sm font-medium text-gray-900 dark:text-gray-300">{{ jour }}</span>
                                                                    </div>
                                                                    <div class="flex items-center space-x-4 flex-1 w-[85%]">
                                                                        <div class="flex-1">
                                                                            <div class="relative">
                                                                                <div class="absolute inset-y-0 end-0 top-0 flex items-center pe-3.5 pointer-events-none">
                                                                                    <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                                                                        <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z" clip-rule="evenodd"/>
                                                                                    </svg>
                                                                                </div>
                                                                                <input type="time" 
                                                                                        name="start-time-{{ jour }}"
                                                                                        class="bg-white border leading-none border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                                                                        value="{{ heures.start }}"
                                                                                        required>
                                                                            </div>
                                                                        </div>
                                                                        <span class="text-gray-500">à</span>
                                                                        <div class="flex-1">
                                                                            <div class="relative">
                                                                                <div class="absolute inset-y-0 end-0 top-0 flex items-center pe-3.5 pointer-events-none">
                                                                                    <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                                                                        <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z" clip-rule="evenodd"/>
                                                                                    </svg>
                                                                                </div>
                                                                                <input type="time" 
                                                                                        name="end-time-{{ jour }}"
                                                                                        class="bg-white border leading-none border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                                                                        value="{{ heures.end }}"
                                                                                        required>
                                                                            </div>
                                                                        </div>
                                                                        <div class="ml-4">
                                                                            <button type="button" class="delete-day inline-flex items-center p-2 text-sm font-medium text-center text-gray-500 hover:text-gray-800 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg focus:outline-none dark:text-gray-400 dark:hover:text-gray-100" onclick="supprimerLigneDisponibilite(this)">
                                                                                <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                                                                    <path fill-rule="evenodd" d="M8.586 2.586A2 2 0 0 1 10 2h4a2 2 0 0 1 2 2v2h3a1 1 0 1 1 0 2v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V8a1 1 0 0 1 0-2h3V4a2 2 0 0 1 .586-1.414ZM10 6h4V4h-4v2Zm1 4a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Zm4 0a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Z" clip-rule="evenodd"/>
                                                                                </svg>
                                                                                <span class="sr-only">Delete</span>
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            {% endfor %}
                                                        </div>
                                                    </div>                                                    
                                                </div>
                                            {% endif %}
                                            <div class="col-span-2">
                                                <label for="message" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Description sur votre facture</label>
                                                <textarea id="message" rows="4" name="description_facture" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Ecrirer ici ...">{{ client.description_facture }}</textarea>          
                                            </div>
                                        </div>
                                        <button type="submit" class="text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                                            Sauvegarder
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- Bouton Supprimer -->
                        <button data-modal-target="popup-modal-{{ client.id }}" data-modal-toggle="popup-modal-{{ client.id }}" type="button" class="px-3 py-2 text-xs font-medium text-center inline-flex items-center text-white rounded-lg focus:ring-4 focus:outline-none focus:ring-red/30 dark:focus:ring-red/40">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="red" d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                        </button>

                        {% comment %} Modal suppression {% endcomment %}
                        <div id="popup-modal-{{ client.id }}" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
                            <div class="relative p-4 w-full max-w-md max-h-full">
                                <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
                                    <button type="button" class="absolute top-3 end-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="popup-modal-{{ client.id }}">
                                        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                                        </svg>
                                        <span class="sr-only">Fermer</span>
                                    </button>
                                    <div class="p-4 md:p-5 text-center">
                                        <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                                        </svg>
                                        <h3 class="mb-5 text-lg font-normal text-gray-500 dark:text-gray-400">Êtes-vous sûr de vouloir supprimer ce client ?</h3>
                                        <a href="{% url 'client:del_client' client.id %}" class="text-white bg-red/60 dark:bg-red/60 hover:bg-red/80 dark:hover:bg-red/80 focus:ring-4 focus:outline-none focus:ring-red/30 dark:focus:ring-red/80 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center me-2">
                                            Oui, supprimer
                                        </a>
                                        <button data-modal-hide="popup-modal-{{ client.id }}" type="button" class="text-gray-500 bg-white hover:bg-gray-100 focus:ring-4 focus:outline-none focus:ring-gray-200 rounded-lg border border-gray-200 text-sm font-medium px-5 py-2.5 hover:text-gray-900 focus:z-10 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-500 dark:hover:text-white dark:hover:bg-gray-600 dark:focus:ring-gray-600">
                                            Non, annuler
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </td>
                </tr>
                {% endfor %}
                    
            </tbody>
        </table>

        {% comment %} Nav pour le tableau {% endcomment %}
        <nav class="flex items-center flex-column flex-wrap md:flex-row justify-between py-5 px-2" aria-label="Table navigation">
          <span class="text-sm font-normal text-gray-500 dark:text-gray-400 mb-4 md:mb-0 block w-full md:inline md:w-auto">Affichage du Page <span class="font-semibold text-gray-900 dark:text-white"> {{ clients_list.number }} </span> sur <span class="font-semibold text-gray-900 dark:text-white">{{ clients_list.paginator.num_pages }}</span></span>
          <ul class="inline-flex -space-x-px rtl:space-x-reverse text-sm h-8">
            {% if clients_list.has_previous %}
              <li>
                  <a href="?page={{ clients_list.previous_page_number }}" class="flex items-center justify-center px-3 h-8 ms-0 leading-tight text-gray-500 bg-white border border-gray-300 rounded-s-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white" >Prev</a>
              </li>
            {% else %}
              <li>
                <button type="button" disabled class="flex items-center justify-center px-3 h-8 ms-0 leading-tight text-gray-500 bg-white border border-gray-300 rounded-s-lg dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 cursor-not-allowed" >Prev</button>
              </li>
            {% endif %}
            
            {% comment %} {% for item in serv_rang %}
              <li>
                <a href="?page={{ services.page }}" class="flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">{{ item }}</a>
              </li>              
            {% endfor %} {% endcomment %}
              
            {% if clients_list.has_next %}
              <li>
                <a href="?page={{ clients_list.next_page_number }}" class="flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 rounded-e-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">Suiv</a>
              </li>
            {% else %}
              <li>
                <button type="button" disabled class="flex items-center justify-center px-3 h-8 leading-tight text-gray-500 bg-white border border-gray-300 rounded-e-lg dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 cursor-not-allowed">Suiv</button>
              </li>
            {% endif %}
          </ul>
      </nav>
    </div>

</div>


<!-- Modal d'inscription -->
<div id="new_client-modal" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
    <div class="relative p-4 w-full lg:max-w-[50vw] max-h-full">
        <!-- Modal content -->
        <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
            <!-- Modal header -->
            <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white">
                    Nouveaux client
                </h3>
                <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-toggle="new_client-modal">
                    <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                    </svg>
                    <span class="sr-only">Close modal</span>
                </button>
            </div>
            <!-- Modal body -->
            <form class="p-4 md:p-5" action="{% url 'client:new_client' %}" enctype="multipart/form-data" method="POST">
                {% csrf_token %}
                <div class="flex flex-col items-center justify-center w-full">
                    <img id="preview-image" class="w-32 h-32 rounded-full object-cover mb-4 hidden" src="/static/images/default-profile.png" alt="Preview">
                    
                    <div id="upload-zone" class="w-full">
                        <label for="photo" class="flex flex-col items-center justify-center w-full h-24 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600">
                            <div class="flex flex-col items-center justify-center w-full pt-5 pb-6">
                                <svg class="w-8 h-8 mb-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 16">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2"/>
                                </svg>
                                <p class="mb-2 text-sm text-center text-gray-500 dark:text-gray-400"><span class="font-semibold">Cliquez pour télécharger votre photo de profil</span> ou glisser-déposer</p>
                                <p class="text-xs text-gray-500 dark:text-gray-400">SVG, PNG, JPG or GIF (MAX. 800x400px)</p>
                            </div>
                            <input id="photo" name="photo" type="file" class="hidden" accept="image/*" onchange="previewImage(this)"/>
                        </label>
                    </div>

                    <button id="cancel-button" type="button" class="hidden mt-4 text-white bg-red-700 hover:bg-red/80 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center items-center dark:bg-red/60 dark:hover:bg-red/70 dark:focus:ring-red-800" onclick="cancelUpload()">
                        Annuler
                        <svg class="w-4 h-4 ms-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                        </svg>
                    </button>
                </div>

                <div class="grid gap-4 mb-4 grid-cols-2">
                    <div class="col-span-2 sm:col-span-1 mt-2">
                        <label for="name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Nom du tier</label>
                        <input type="text" name="name" id="name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Type product name" required="">
                    </div>
                    <div class="col-span-2 sm:col-span-1 mt-2">
                        <label for="commercial_name" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Nom alternatif (commercial, marque, ...)</label>
                        <input type="text" name="commercial_name" id="commercial_name" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Type product name" required="">
                    </div>
                    <div class="col-span-2">
                        <label for="post" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Poste</label>
                        <input type="text" name="post" id="post" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Type product name">
                    </div>
                    <div class="col-span-2 sm:col-span-1">
                        <label for="tel1" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">N° Tel 1</label>
                        <input type="tel" name="tel" id="tel1" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="+261 xx xxx xx" required="">
                    </div>
                    <div class="col-span-2 sm:col-span-1">
                        <label for="tel2" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">N° Tel 2</label>
                        <input type="tel" name="tel2" id="tel2" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="+261 xx xxx xx">
                    </div>
                    <div class="col-span-2 sm:col-span-1">
                        <label for="email" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Email</label>
                        <input type="email" name="email" id="email" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="exemple@gmail.com" required="">
                    </div>
                    <div class="col-span-2 sm:col-span-1">
                        <label for="adresse" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Adresse</label>
                        <input type="text" name="adresse" id="adresse" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-500 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500" placeholder="Ex: Rue de la belle vie ..." >
                    </div>
                    <div class="col-span-2">
                        <label for="countries" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Type du client</label>
                        <select id="countries" name='type_client' class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                            <option value="Client" selected>Client</option>
                            <option value="Prospect">Prospect</option>
                            <option value="Fourniseur">Fourniseur</option>
                            <option value="Client-Prospect">Client - Prospect</option>
                            <option value="Client-Fourniseur">Client - Fourniseur</option>
                        </select>
                    </div>
                    {% comment %} Disponibilité {% endcomment %}
                    <div class="mb-6 col-span-2">
                        <label for="countries" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Disponibilité</label>
                        
                        <div class="flex items-center space-x-4 mb-4">
                            <select id="day-selector" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500">
                                <option value="">Sélectionner un jour</option>
                                <option value="Lundi - Vendredi">Lundi - Vendredi</option>
                                <option value="Lundi">Lundi</option>
                                <option value="Mardi">Mardi</option>
                                <option value="Mercredi">Mercredi</option>
                                <option value="Jeudi">Jeudi</option>
                                <option value="Vendredi">Vendredi</option>
                                <option value="Samedi">Samedi</option>
                                <option value="Dimanche">Dimanche</option> 
                            </select>
                        </div>

                        <div id="days-container" class="space-y-4">
                            <!-- Les jours sélectionnés seront ajoutés ici dynamiquement -->
                        </div>
                    </div>                   
                    
                    <div class="col-span-2">
                        <label for="message" class="block mb-2 text-sm font-medium text-gray-900 dark:text-white">Description sur votre facture</label>
                        <textarea id="message" rows="4" name="description_facture" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500" placeholder="Ecrirer ici ..."></textarea>          
                    </div>
                </div>
                <button type="submit" class="text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800">
                    <svg class="me-1 -ms-1 w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd"></path></svg>
                    Enregistrer
                </button>
            </form>
        </div>
    </div>
</div> 


 <script>
    function factDataComponent(){
        return {
          client_view_list: 'true',
          init(){
            // Charger les données depuis localStorage
            this.client_view_list = localStorage.getItem('client_view_list') === 'true';
          },
          saveClientView(){
            //Sauvegarder les données dans localStorage
            console.log('save')
            localStorage.setItem('client_view_list', this.client_view_list)
          }
        }
      }

    document.addEventListener('DOMContentLoaded', function() {
        const daySelector = document.getElementById('day-selector');
        const daysContainer = document.getElementById('days-container');
        const selectedDays = new Set();

        function createTimeInputRow(dayValue, dayLabel) {
            return `
                <div class="flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg">
                    <div class="flex items-center mr-2 w-[15%]">
                        <span class="text-sm font-medium text-gray-900 dark:text-gray-300">${dayLabel}</span>
                    </div>
                    <div class="flex items-center space-x-4 flex-1 w-[85%]">
                        <div class="flex-1">
                            <div class="relative">
                                <div class="absolute inset-y-0 end-0 top-0 flex items-center pe-3.5 pointer-events-none">
                                    <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                        <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <input type="time" 
                                        name="start-time-${dayValue}"
                                        class="bg-white border leading-none border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                        value="09:00"
                                        required>
                            </div>
                        </div>
                        <span class="text-gray-500">à</span>
                        <div class="flex-1">
                            <div class="relative">
                                <div class="absolute inset-y-0 end-0 top-0 flex items-center pe-3.5 pointer-events-none">
                                    <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                        <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z" clip-rule="evenodd"/>
                                    </svg>
                                </div>
                                <input type="time" 
                                        name="end-time-${dayValue}"
                                        class="bg-white border leading-none border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                        value="17:00"
                                        required>
                            </div>
                        </div>
                    </div>
                    <div class="ml-4">
                        <button type="button" class="delete-day inline-flex items-center p-2 text-sm font-medium text-center text-gray-500 hover:text-gray-800 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg focus:outline-none dark:text-gray-400 dark:hover:text-gray-100">
                            <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                <path fill-rule="evenodd" d="M8.586 2.586A2 2 0 0 1 10 2h4a2 2 0 0 1 2 2v2h3a1 1 0 1 1 0 2v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V8a1 1 0 0 1 0-2h3V4a2 2 0 0 1 .586-1.414ZM10 6h4V4h-4v2Zm1 4a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Zm4 0a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Z" clip-rule="evenodd"/>
                            </svg>
                            <span class="sr-only">Delete</span>
                        </button>
                    </div>
                </div>
            `;
        }

        function addDayElement(dayValue, dayLabel) {
            if (selectedDays.has(dayValue)) return;

            selectedDays.add(dayValue);
            const dayElement = document.createElement('div');
            dayElement.innerHTML = createTimeInputRow(dayValue, dayLabel);

            const deleteButton = dayElement.querySelector('.delete-day');
            deleteButton.addEventListener('click', function() {
                dayElement.remove();
                selectedDays.delete(dayValue);
                daySelector.value = '';
            });

            daysContainer.appendChild(dayElement);
        }

        daySelector.addEventListener('change', function() {
            const selectedDay = this.value;
            if (!selectedDay) return;

            if (selectedDay === 'Lundi - Vendredi') {
                // Nettoyer le conteneur existant
                daysContainer.innerHTML = '';
                selectedDays.clear();
                
                // Ajouter une seule ligne pour Lundi-Vendredi
                const dayElement = document.createElement('div');
                dayElement.innerHTML = createTimeInputRow('Lundi - Vendredi', 'Lundi - Vendredi');
                
                const deleteButton = dayElement.querySelector('.delete-day');
                deleteButton.addEventListener('click', function() {
                    dayElement.remove();
                    selectedDays.clear();
                    daySelector.value = '';
                });

                daysContainer.appendChild(dayElement);
                selectedDays.add('Lundi - Vendredi');
            } else {
                // Si on a déjà Lundi-Vendredi et que le jour sélectionné n'est pas Samedi ou Dimanche, le supprimer
                if (selectedDays.has('Lundi - Vendredi') && ['Samedi', 'Dimanche'].indexOf(selectedDay) === -1) {
                    daysContainer.innerHTML = '';
                    selectedDays.clear();
                }
                // Ajouter un seul jour
                const dayLabel = this.options[this.selectedIndex].text;
                addDayElement(selectedDay, dayLabel);
            }
            
            this.value = '';
        });
    });
    

    function previewImage(input) {
        const preview = document.getElementById('preview-image');
        const uploadZone = document.getElementById('upload-zone');
        const cancelButton = document.getElementById('cancel-button');
        
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            
            reader.onload = function(e) {
                preview.src = e.target.result;
                preview.classList.remove('hidden');
                uploadZone.classList.add('hidden');
                cancelButton.classList.remove('hidden');
                cancelButton.classList.add('inline-flex');
            }
            
            reader.readAsDataURL(input.files[0]);
        }
    }

    function cancelUpload() {
        const preview = document.getElementById('preview-image');
        const uploadZone = document.getElementById('upload-zone');
        const cancelButton = document.getElementById('cancel-button');
        const photoInput = document.getElementById('photo');

        preview.classList.add('hidden');
        uploadZone.classList.remove('hidden');
        cancelButton.classList.add('hidden');
        photoInput.value = ''; // Reset input file
    }

    // Ajout de ligne pour la disponibilité en modif du client
    function ajouterLigneDisponibilite(jour, id) {
        if (jour) {
            var ligne = document.createElement('div');
            ligne.className = "flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg";
            ligne.innerHTML = `
                <div class="flex items-center mr-2 w-[15%]">
                    <span class="text-sm font-medium text-gray-900 dark:text-gray-300">${jour}</span>
                </div>
                <div class="flex items-center space-x-4 flex-1 w-[85%]">
                    <div class="flex-1">
                        <div class="relative">
                            <div class="absolute inset-y-0 end-0 top-0 flex items-center pe-3.5 pointer-events-none">
                                <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                    <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z" clip-rule="evenodd"/>
                                </svg>
                            </div>
                            <input type="time" 
                                    name="start-time-${jour}"
                                    class="bg-white border leading-none border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                    required>
                        </div>
                    </div>
                    <span class="text-gray-500">à</span>
                    <div class="flex-1">
                        <div class="relative">
                            <div class="absolute inset-y-0 end-0 top-0 flex items-center pe-3.5 pointer-events-none">
                                <svg class="w-4 h-4 text-gray-500 dark:text-gray-400" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                    <path fill-rule="evenodd" d="M2 12C2 6.477 6.477 2 12 2s10 4.477 10 10-4.477 10-10 10S2 17.523 2 12Zm11-4a1 1 0 1 0-2 0v4a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586V8Z" clip-rule="evenodd"/>
                                </svg>
                            </div>
                            <input type="time" 
                                    name="end-time-${jour}"
                                    class="bg-white border leading-none border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-600 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
                                    required>
                        </div>
                    </div>
                    <div class="ml-4">
                        <button type="button" class="delete-day inline-flex items-center p-2 text-sm font-medium text-center text-gray-500 hover:text-gray-800 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg focus:outline-none dark:text-gray-400 dark:hover:text-gray-100" onclick="supprimerLigneDisponibilite(this)">
                            <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                <path fill-rule="evenodd" d="M8.586 2.586A2 2 0 0 1 10 2h4a2 2 0 0 1 2 2v2h3a1 1 0 1 1 0 2v12a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V8a1 1 0 0 1 0-2h3V4a2 2 0 0 1 .586-1.414ZM10 6h4V4h-4v2Zm1 4a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Zm4 0a1 1 0 1 0-2 0v8a1 1 0 1 0 2 0v-8Z" clip-rule="evenodd"/>
                            </svg>
                            <span class="sr-only">Delete</span>
                        </button>
                    </div>
                </div>
            </div>
        `;
            document.getElementById(`disponibilite-dynamique-${id}`).appendChild(ligne);
        }
    }
    function supprimerLigneDisponibilite(button) {
        button.parentNode.parentNode.parentNode.remove();
    }
    
    // Partie dynamique de modif image du client
    function toggleUploadZone(id) {
        var previewImage = document.getElementById('preview-image-' + id);
        var uploadZone = document.getElementById('upload-zone-' + id);
        previewImage.classList.toggle('hidden');
        uploadZone.classList.toggle('hidden');
    }

    function editpreviewImage(input, id) {
        var previewImage = document.getElementById('preview-image-' + id);
        var file = input.files[0];
        var reader = new FileReader();

        reader.onload = function(e) {
            previewImage.src = e.target.result;
            console.log(previewImage.src)
        };

        reader.readAsDataURL(file);
        toggleUploadZone(id);
        input.classList.add('hidden');
    }
</script>

{% endblock contentPage %}